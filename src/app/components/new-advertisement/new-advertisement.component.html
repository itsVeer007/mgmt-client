<div class="container-fluid" id="top">
    <!-- header -->
    <div class="d-flex align-items-center justify-content-between">
      <div class="users-header">
        <p>List of Advertisements - <span>{{ newlistAdsInfoData?.length }}</span></p>
      </div>
  
      <div>
        <!-- <button mat-flat-button color="primary" (click)="showAddAsset(siteIdInput.value, deviceIdInput.value)">Create Add</button> -->
        <button class="create-btn" (click)="showAddAsset('asset')">Create Add</button>
      </div>
    </div>
  
    <!-- status -->
    <div class="row mb-2">
      <div class="col-lg-1 col-md-1 d-flex justify-content-start">
        <div class="vl-yellow"></div>
        <div class="mx-2">
          <div class="status">Pending</div>
          <div class="count">{{ pending?.length }}</div>
        </div>
      </div>
  
      <div class="col-lg-1 col-md-1 d-flex justify-content-start">
        <div class="vl-green"></div>
        <div class="mx-2">
          <div class="status">Added</div>
          <div class="count">{{ addedAd?.length }}</div>
        </div>
      </div>
  
      <div class="col-lg-1 col-md-1 d-flex justify-content-start">
        <div class="vl-blue"></div>
        <div class="mx-2">
          <div class="status">Activated</div>
          <div class="count">{{ activated?.length }}</div>
        </div>
      </div>
  
      <div class="col-lg-1 col-md-1 d-flex justify-content-start">
        <div class="vl-orange"></div>
        <div class="mx-2">
          <div class="status">Deactivated</div>
          <div class="count">{{ Deactivated?.length }}</div>
        </div>
      </div>
  
      <div class="col-lg-1 col-md-1 d-flex justify-content-start">
        <div class="vl-red"></div>
        <div class="mx-2">
          <div class="status">Removed</div>
          <div class="count">{{ removed?.length }}</div>
        </div>
      </div>
    </div>
  
    <div>
      <!-- <div class="col-lg-12"> -->
        <!-- <app-filter [filterType]="'advertisements'" (tableDataFromChild)="getAdsFromChild($event)"
          (searchFromChild)="getSearchFromChild($event)" (loaderFromChild)="getLoaderFromChild($event)">
        </app-filter> -->
      <!-- </div> -->
    </div>


    <div class="row">
      <div class="col-lg-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Site</mat-label>
          <input matInput #siteIdInput [matAutocomplete]="site" [(ngModel)]="siteId">
          <button matSuffix mat-icon-button>
            <mat-icon>arrow_drop_down</mat-icon>
          </button>
          <mat-autocomplete #site="matAutocomplete">
            <mat-option value="All" (click)="filter('All')">All</mat-option>
            <mat-option *ngFor="let item of siteData" [value]="item.siteId" (click)="filter(item.siteId)">{{item.siteId}}</mat-option>
            <mat-option></mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>
      <div class="col-lg-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Device</mat-label>
          <input matInput #deviceIdInput type="text" [matAutocomplete]="device" [(ngModel)]="deviceId">
          <button matSuffix mat-icon-button>
            <mat-icon>arrow_drop_down</mat-icon>
          </button>
          <mat-autocomplete #device="matAutocomplete">
            <mat-option value="All" (click)="filter('All')">All</mat-option>
            <mat-option *ngFor="let item of listAdsInfoData" [value]="item.deviceId" (click)="filter(item.deviceId)">{{item.deviceId}}</mat-option>
            <mat-option></mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>
      <div class="col-lg-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Ads Name</mat-label>
          <input matInput #addIdInput type="text" [matAutocomplete]="add" [(ngModel)]="adName">
          <button matSuffix mat-icon-button>
            <mat-icon>arrow_drop_down</mat-icon>
          </button>
          <mat-autocomplete #add="matAutocomplete">
            <mat-option value="All" (click)="filter('All')">All</mat-option>
            <mat-option *ngFor="let item of newlistAdsInfoData" [value]="item.adName" (click)="filter(item.deviceId)">{{item.adName}}</mat-option>
            <mat-option></mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>
      <div class="col-lg-3">
        <mat-form-field class="example-form-field" appearance="outline" class="w-100">
          <mat-label>Search</mat-label>
          <input matInput type="text" [(ngModel)]="searchText">
          <button matSuffix mat-icon-button>
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </div>
    </div>

  
  
    <!-- table -->
    <div class="table-resp extra w-100">
      <table class="table table-hover" id="mytable">
        <thead>
          <tr class="form1">
            <th>
              <span>Id</span>
              <img (click)="sort('id')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th>
  
            <th>
              <span>AdName</span>
              <img (click)="sort('name')" class="pointer ms-1" src="assets/icons/sorticon.svg" matTooltip="filter"
                matTooltipPosition="right" width="15px">
            </th>
  
            <th>
              <span>Duration</span>
              <img (click)="sort('deviceModeId')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th>
<!--   
            <th>
              <span></span>
              <img (click)="sort('duration')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th> -->
  
            <th>
              <span>Start Date</span>
              <img (click)="sort('fromDate')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th>
  
            <th>
              <span>End Date</span>
              <img (click)="sort('toDate')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th>
  
            <th>
              <span>Status</span>
              <img (click)="sort('status')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
            </th>
  
            <th class="text-center">Play</th>
            <th><p>Rules</p></th>
  
            <th class="text-center">Actions</th>
          </tr>
        </thead>
  
        <tbody *ngIf="!tableLoader">
          <tr *ngFor="let item of newlistAdsInfoData | search: searchText; let i=index;">
            <!-- <td>
              <input type="checkbox"
              class="form-check-input"
              [(ngModel)]="item.selected"
              (change)="checkIfAllSelected();
              deleteMultiRecords(item, $event);
              ViewByCheckbox(item, $event);
              EditByCheckbox(item, $event)"
              id="singleCheck">
            </td> -->
            
            <td>{{i+1}}</td>
            <td>
              <p>{{ item.adName }}</p>
            </td>
            <td>
              <p>{{item.duration + 's'}}</p>
            </td>
            <td>
              <p>{{item.fromDate | date:'mediumDate' }}</p>
            </td>
  
            <td>
              <p>{{ item.toDate | date:'mediumDate' }}</p>
            </td>
            <td>{{ item.status == 1 ? 'Pending' : item.status == 2 ? 'Added' : item.status == 3 ? 'Removed' : item.status == 4 ? 'Activated' : item.status == 5 ? 'Deactivated' : ''}}</td>
            <td class="text-center">
              <!-- <a class="pointer" [href]="item.url" target="_blank">
                <img style="color: #bdb8b8;" src="assets/icons/play.svg" width="25" height="25" />
              </a> -->
              <a class="pointer" (click)="openPlayerDialog(item)">
                <img style="color: #bdb8b8;" src="assets/icons/play.svg" width="25" height="25" />
              </a>
            </td>
  
            <!-- <td style="width: 200px;">
              <p>{{ item.name.slice(0, -4) }}</p>
            </td> -->
  
            <!-- <td>
              <p>{{ item.deviceId ? item.deviceId : '--' }}</p>
            </td> -->
<!--   
            <td>
              <p *ngIf="item.deviceModeId == 1">Continuous</p>
              <p *ngIf="item.deviceModeId == 2">Weather Based</p>
              <p *ngIf="item.deviceModeId == 3">AI Based</p>
          
            </td> -->
  
           
  
           
  
            <!-- <td>
              <button style="background: transparent; border: none;" (click)="showAddAsset()">
                <img src="assets/icons/add.svg" alt="" width="30" height="30">
              </button>
            </td> -->
  
            <td class="text-center">
              <a class="pointer" *ngIf="item.rules === 0 ">
                <img style="color: #dd6868;" src="assets/icons/add.svg" width="50" height="25" />
              </a>
              <span  *ngIf="item.rules !== 0" (click)="openView(item)">View</span>
            </td>
  
           
  
            <td class="table-icons">
              <a class="mx-1 pointer" (click)="openViewPopup(item)">
                <img src="assets/icons/view.svg">
              </a>
              <a class="mx-1 pointer" (click)="openEditPopupp(item)" matTooltip="edit">
                <img src="assets/icons/edit.svg">
              </a>
              <a class="mx-1 pointer" value="Delete" (click)="openDeletePopup(item)" matTooltip="delete">
                <img src="assets/icons/delete.svg">
              </a>
            </td>
          </tr>
        </tbody>
      </table>
  
      <!-- error info -->
      <div class="d-flex align-items-center justify-content-center" style="height: 45vh;"
        *ngIf="newlistAdsInfoData.length == 0 && !tableLoader">
        <h1 class="text-secondary">No Advertisements</h1>
      </div>
  
      <!-- loader -->
      <div *ngIf="tableLoader">
        <app-loader class="d-flex justify-content-center align-items-center" style="height: 45vh;"></app-loader>
      </div>
    </div>
  </div>
  

  <ng-template #usedItemsDialog>
    <div style="background-color: #084982;" >
      <p class="dialog-title">view</p>
    </div>
  
    <div class="dialog-content">
      <div class="table-res">
        <table class="table" id="mytable">
          <thead>
            <tr class="form1">
              <th>
                <span>Id</span>
                <!-- <img (click)="sort1('time_connected')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px"> -->
              </th>
              <th>
                <span>workingDays</span>
                <!-- <img (click)="sort1('active_count')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px"> -->
              </th>
              <th>
                <span>temp</span>
                <!-- <img (click)="sort1('inactive_count')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px"> -->
              </th>
  
              <th>
                <span>status</span>
                <!-- <img (click)="sort1('active_count')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px"> -->
              </th>
              <th>objectCount
                <!-- <img (click)="sort1('avg_time_spent')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px"> -->
              </th>
              <th >
                <span>modelObjectTypeId</span>
              </th>
            </tr>
          </thead>
  
          <tbody>
            <tr  *ngFor="let task of ruleData; let i = index">
              <td>
                <p>{{i+1 }}</p>
              </td>
              <td >
                <p >{{ task.workingDays }}</p>
              </td>
              <td>
                <p>{{ task.temp}}</p>
              </td>
              <td>
                <p>{{ task.status }}</p>
              </td>
              <td>
                <p>{{ task.objectCount }}</p>
              </td>
              <td >{{task.modelObjectTypeId}}</td>
  
            </tr>
          </tbody>
        </table>
      </div>
      
    </div>
  
    <div class="d-flex justify-content-end">
      <button class="dialog-close-btn" mat-dialog-close>Close</button>
    </div>
  </ng-template>
  
  <ng-template #editAssetDialog>
    <div style="background-color: #084982;">
      <p class="dialog-title">MODIFY Ad - {{ currentItem?.deviceId }} ({{ currentItem?.mimeType.slice(0, -4) }})</p>
    </div>
  
    <div class="dialog-content">
      <div class="row m-0" *ngIf="currentItem">
        <div class="col-lg-6">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>From date</mat-label>
            <input  matInput [matDatepicker]="picker1" [(ngModel)]="currentItem.fromDate">
            <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>
        </div>
  
        <div class="col-lg-6">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>To date</mat-label>
            <input matInput [matDatepicker]="picker2" [(ngModel)]="currentItem.toDate">
            <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>
        </div>
  
        <div class="col-lg-6">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Status</mat-label>
            <mat-select  [(ngModel)]="currentItem.status">
              <mat-option *ngFor="let item of addStatus" [value]="item.keyId">
                {{ item.value }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </div>
  
    <div class="d-flex align-items-center justify-content-end">
      <div>
        <button class="dialog-close-btn" mat-dialog-close>Close</button>
      </div>
      <div>
        <button class="dialog-update-btn" mat-dialog-close (click)="updateAd()">Update</button>
      </div>
    </div>
  </ng-template>
  
  <ng-template #deleteAssetDialog>
    <div style="background-color: #084982;">
      <p class="dialog-title">Delete ADVERTISEMENT</p>
    </div>
  
    <div class="dialog-content">
      <div>Do you want to delete this item?</div>
    </div>
  
    <div class="d-flex align-items-center justify-content-end">
      <div>
        <button class="dialog-close-btn" mat-dialog-close>Close</button>
      </div>
      <div>
        <button class="dialog-update-btn" mat-dialog-close (click)="confirmDeleteRow()">OK</button>
      </div>
    </div>
  </ng-template>
  
  <ng-template #addPlayerDialog>
    <div style="background-color: #084982;">
      <p class="dialog-title">ADD FILE</p>
    </div>
    <div class="dialog-content">
      <video [src]="currentItem?.url" width="500px" height="300px" autoplay controls></video>
    </div>
    <div class="d-flex align-items-center justify-content-end">
      <div>
        <button class="dialog-close-btn" mat-dialog-close>Close</button>
      </div>
    </div>
  </ng-template>
  
  
  <div *ngIf="showAsset">
    <app-add-new-advertisement (newItemEvent)="closenow('asset'); listAdsInfo()"></app-add-new-advertisement>
  </div>