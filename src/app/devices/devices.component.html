<div class="container-fluid users" id="top">
  <!-- header -->
  <div class="d-flex justify-content-between align-items-center">
    <div class="users-header">
      <p class="m-0">Total Devices - <span>{{ deviceData?.length }}</span></p>
    </div>

    <div style="position: relative;">
      <!-- <a class="pointer" (click)="show('device')"><img src="assets/icons/add.svg" alt="" /></a> -->
      <button mat-flat-button color="primary" class="py-0" (click)="show('device')">Create Device</button>
    </div>
  </div>
  <!-- /header -->

  <!-- count -->
  <div class="row">
    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-green"></div>
      <div class="mx-2">
        <div class="status">Online</div>
        <div class="count">{{ active?.length }}</div>
      </div>
    </div>
    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-red"></div>
      <div class="mx-2">
        <div class="status">Offline</div>
        <div class="count">{{ inActive?.length }}</div>
      </div>
    </div>
  </div>
  <!-- /count -->

  <!-- form -->
  <div class="search-form d-flex align-items-center justify-content-between mt-2 mb-1">
    <div class="row col-lg-10 col-md-10">
      <div class="col-lg-2 col-md-2 col-sm-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Site</mat-label>
          <mat-select>
            <mat-option *ngFor="let item of siteData" [value]="item.siteid" (click)="filterSiteId_Name(item.siteId_Name)">{{ item.siteid }} - {{ item.siteShortName }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="col-lg-2 col-md-2 col-sm-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Device Type</mat-label>
          <mat-select>
            <mat-option *ngFor="let item of deviceType" [value]="item.keyId" (click)="filterDeviceType(item.deviceType)">{{ item.value }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="col-lg-2 col-md-2 col-sm-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Select Status</mat-label>
          <mat-select>
            <mat-option *ngFor="let item of deviceStatus" [value]="item.keyId">{{ item.value }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="filter-search-btn col-lg-2 col-sm-12">
        <!-- <button mat-flat-button color="primary" class="p-0" (click)="applyFilter()">Submit</button> -->
        <button>Submit</button>
      </div>

      <!-- <div class="col-lg-3 col-md-3 col-sm-12">
        <mat-form-field class="example-form-field" appearance="outline" class="w-100">
          <mat-label>Search</mat-label>
          <input matInput type="text"  [(ngModel)]="searchText">
          <button matSuffix mat-icon-button>
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </div> -->
    </div>
  </div>
  <!-- /form -->

  <div class="row py-2 mx-1 mb-3 text-white" style="background-color: #084982; border-radius: 3px; font-weight: 600;">
    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
    </div>

    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
    </div>

    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
      <div class="row py-1 mt-1 me-3" style="background-color: #3a6da4; border-radius: 2px;">
        <div class="col-lg-6">
          <span><img class="mb-1" src="assets/icons/green-dot.png" alt="" width="18"></span>
          <span>1</span>
        </div>
        <span class="col-lg-6">0</span>
      </div>
    </div>

    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
      <div class="row py-1 mt-1 me-3" style="background-color: #3a6da4; border-radius: 2px;">
        <span class="col-lg-6"><img class="mb-1" src="assets/icons/red-dot.png" alt="" width="18">1</span>
        <span class="col-lg-6">0</span>
      </div>
    </div>

    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
      <div class="row py-1 mt-1 me-3" style="background-color: #3a6da4; border-radius: 2px;">
        <span class="col-lg-6">1</span>
        <span class="col-lg-6">0</span>
      </div>
    </div>

    <div class="col-lg-2">
      <p class="m-0">Sites</p>
      <p class="m-0" style="font-size: 16px;">2</p>
      <div class="row py-1 mt-1 me-3" style="background-color: #3a6da4; border-radius: 2px;">
        <span class="col-lg-6">1</span>
        <span class="col-lg-6">0</span>
      </div>
    </div>
  </div>

  <!-- table starts -->
  <div class="table-resp">
    <table class="table" id="mytable">
      <tbody>
        <tr class="form1">
          <!-- <th>
            <input type="checkbox" class="form-check-input" [(ngModel)]="selectedAll" (change)="selectAll()"
              id="allcheck" style="
                background-color: #00000000;
                border-color: #fff;
                margin-left: 10px;
              " />
          </th> -->

          <th>
            <span>Id</span>
            <img (click)="sort('deviceId')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
          </th>

          <th>
            <span>Type</span>
            <img (click)="sort('deviceTypeId')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
          </th>

          <th>
            <span>Site Details</span>
            <img (click)="sort('siteId')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
          </th>

          <th>
            <span>Status</span>
            <img (click)="sort('status')" class="pointer ms-1" src="assets/icons/sorticon.svg" width="15px">
          </th>

          <th>Reboot</th>

          <th>
            <span>Uptime</span>
          </th>
          <!-- <th></th> -->
        </tr>

        <tr *ngFor="let cust of deviceData | search : searchText; let i = index">
          <!-- <td>
            <input type="checkbox" name="foo" class="form-check-input" [(ngModel)]="cust.selected" (change)="
                checkIfAllSelected();
                deleteMultiRecords(cust, i, $event);
                ViewByCheckbox(cust, i, $event);
                EditByCheckbox(cust, i, $event)
              " id="singleCheck" />
          </td> -->
          <!-- <td><input type="checkbox" class="form-check-input" [checked]="masterSelected" /></td> -->
          <td>
            <p>{{ cust.deviceId }}</p>
          </td>
          <td>
            <p>{{ cust.deviceTypeId == 1 ? 'Audio' : cust.deviceTypeId == 2 ? 'Video': cust.deviceTypeId == 3 ? 'Wifi' : '--'}}</p>
          </td>
          <td>
            <p>{{ cust.siteId }}</p>
          </td>
          <td>
            <p [style.color]="cust.status == 1 ? '#00A44C' : cust.status == 2 ? '#fa500f' : ''">
              {{ cust.status == 1 ? 'Online' : cust.status == 2 ? 'Offline' : '--' }}
            </p>

            <!-- <p [style.color]="cust.status == 'active' ? '#00A44C' : cust.status == 'Inprogress' ? '#F5B400' : cust.status == 'closed' ? '#fa500f' : '#00A44C'">
              <span class="d-flex">
                <span style="width: 50px;">
                  {{ cust.status }}
                </span>

                <a (click)="openEditStatus(cust)" class="ms-2 pointer">
                  <img src="assets/icons/edit.svg"  width="13">
                </a>
              </span>

              <ng-template #editStatusDialog>
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Edit Status</mat-label>
                  <mat-select [(ngModel)]="staObj.status">
                    <mat-option value="closed">closed</mat-option>
                  </mat-select>
                </mat-form-field>
                <button mat-stroked-button style="color: #084982" (click)="changeAssetStatus()">Submit</button>
              </ng-template>
            </p> -->
          </td>

          <td (click)="rebootDevice(cust.deviceId)">
            <img class="pointer" style="opacity: 0.7;" src="assets/icons/restart.svg" width="25" height="25">
          </td>

          <td>
            <p *ngFor="let item of upTime" >
              <span *ngIf="item.deviceId == cust.deviceId">{{ item.firstConnected | date: 'HH.mm' }}</span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <!-- /table -->
  </div>

  <!-- Loader -->
  <div *ngIf="showLoader" class="d-flex justify-content-center align-items-center" style="height: 50vh;">
    <app-loader></app-loader>
  </div>
  <!-- /Loader -->
</div>


<div class="modalitem max-center" [hidden]="deletePopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Delete Row</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeDeletePopup()">
    </div>
    <div class="card-body text-center">Do you want to delete this item?</div>
    <div class="card-footer">
      <button type="button" class="btn btn-primary mx-2" (click)="confirmDeleteRow()">
        OK
      </button>
      <button type="button" class="btn btn-danger" (click)="closeDeletePopup()">
        Close
      </button>
    </div>
  </div>
</div>

<div class="modalitem max-center" [hidden]="editPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Edit</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeEditPopup()" />
    </div>
    <div class="card-body text-center">
      <div *ngIf="currentItem">
        <!-- <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Product Brand</mat-label>
            <mat-select [(ngModel)]="currentItem.site">
              <mat-option></mat-option>
            </mat-select>
          </mat-form-field>
        </div> -->

        <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Ticket Id</mat-label>
            <input matInput [(ngModel)]="currentItem.ticketId">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Site</mat-label>
            <input matInput [(ngModel)]="currentItem.site">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Description</mat-label>
            <input matInput [(ngModel)]="currentItem.description">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Priority</mat-label>
            <input matInput [(ngModel)]="currentItem.priority">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Status</mat-label>
            <input matInput [(ngModel)]="currentItem.status">
          </mat-form-field>
        </div>
      </div>
    </div>
    <div class="card-footer">
      <button type="button" class="btn mx-2" style="background-color: #084982; color: #ffffff;" (click)="updateTicket(currentItem)">
        Update
      </button>
      <button type="button" class="btn btn-danger" (click)="closeEditPopup()">
        Close
      </button>
    </div>
  </div>
</div>

<div class="modalitem max-center" [hidden]="viewPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Customers</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeViewPopup()" />
    </div>
    <div class="card-body text-center">
      <ul *ngIf="currentItem">
        <li>
          <h6 style="width: 110px">Site Id</h6>
          : {{ currentItem?.siteId }}
        </li>
        <li>
          <h6 style="width: 110px">Customer Name</h6>
          : {{ currentItem?.customerName }}
        </li>
        <li>
          <h6 style="width: 110px">Cust Type</h6>
          : {{ currentItem?.custType }}
        </li>
        <li>
          <h6 style="width: 110px">Contact Number</h6>
          : {{ currentItem?.contactNumber }}
        </li>
        <li>
          <h6 style="width: 110px">Email Id</h6>
          : {{ currentItem?.emailId }}
        </li>
        <li>
          <h6 style="width: 110px">Contact Person</h6>
          : {{ currentItem?.contactPerson }}
        </li>
        <li>
          <h6 style="width: 110px">Address</h6>
          : {{ currentItem?.address }}
        </li>
        <li>
          <h6 style="width: 110px">Status</h6>
          : {{ currentItem?.status }}
        </li>
      </ul>
    </div>
    <div class="card-footer">
      <!-- <button type="button" class="btn btn-primary" (click)="confirmViewRow()">OK</button> -->
      <button type="button" class="btn btn-danger" (click)="closeViewPopup()">
        Close
      </button>
    </div>
  </div>
</div>


<div style="position: fixed; top: 70px; right: 0; z-index: 99; width: 100%;" *ngIf="showAddDevice">
  <app-add-new-device (newItemEvent)="closenow('device', $event)"></app-add-new-device>
</div>
