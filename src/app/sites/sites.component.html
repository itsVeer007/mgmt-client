<div class="container-fluid sites">

  <!-- header -->
  <div class="d-flex justify-content-between">
    <div class="sites-header">
      <p>List of all Sites - <span>{{tableData.length}}</span></p>
    </div>
    <div style="position: relative;">
      <a class="pointer" (click)="show('site')"><img src="assets/images/add.svg" alt="" /></a>
      <a>
        <img src="assets/images/sites-img.svg" alt="" style="border-radius: 24px; box-shadow: 7px 7px 7px 0px #f3f3f3; margin-top: -9px;">
      </a>
    </div>
  </div>
  <!-- /header -->

  <!-- count -->
  <div class="row Active-list">
      <div class="col-lg-1 col-md-1 col-sm-2 col-xs-2 d-flex justify-content-start">
          <div class="vl-green"></div>
          <div class="mx-2">
              <div class="status">Active</div>
              <div class="count">22000</div>
          </div>
      </div>
      <div class="col-lg-1 col-md-1 col-sm-2 col-xs-2 d-flex justify-content-start">
          <div class="vl-red"></div>
          <div class="mx-2">
              <div class="status">Inactive</div>
              <div class="count">1000</div>
          </div>
      </div>
      <div class="col-lg-1 col-md-1 col-sm-2 col-xs-2 d-flex justify-content-start">
          <div class="vl-yellow"></div>
          <div class="mx-2">
              <div class="status">Onhold</div>
              <div class="count">2000</div>
          </div>
      </div>
  </div>
  <!-- /count -->

  <!-- form -->
  <div class="search-form d-flex align-items-center justify-content-between my-2">
    <div class="row col-lg-10 col-md-10">
      <div class="col-lg-3 col-md-3 col-sm-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Site Name</mat-label>
          <mat-select>
            <mat-option (click)="sort('siteName')">Filter by A-Z</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="col-lg-3 col-md-3 col-sm-12">
        <mat-form-field class="example-form-field" appearance="outline" class="w-100">
          <mat-label>Search</mat-label>
          <input matInput type="text"  [(ngModel)]="searchText">
          <button matSuffix mat-icon-button>
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </div>
    </div>

    <div class="col-lg-2 col-md-2 table-icons">
        <div class="lists" *ngIf="showIconView" style="margin-right: 60px; margin-top: -40px;">View</div>
        <div class="lists" *ngIf="showIconEdit" style="margin-right: 30px; margin-top: -40px;">Edit</div>
        <div class="lists" *ngIf="showIconDelete" style="margin-right: -5px; margin-top: -40px;">Delete</div>

        <a class="mx-2" (click)="viewBySelectedOne()"><img src="assets/images/view.svg" (mouseenter)="showIconView = true" (mouseleave)="showIconView = false" /></a>
        <a class="mx-2" (click)="editBySelectedOne()"><img src="assets/images/edit.svg" (mouseenter)="showIconEdit = true" (mouseleave)="showIconEdit = false" /></a>
        <a class="mx-2" (click)="deleteSelected()"><img src="assets/images/delete.svg" (mouseenter)="showIconDelete = true" (mouseleave)="showIconDelete = false" /></a>
    </div>
  </div>
  <!-- /form -->

  <!-- table -->
  <div class="table-resp">
      <table class="table">
          <tbody>
            <tr class="form1">
              <th><input type="checkbox" class="form-check-input" [(ngModel)]="selectedAll"
                      (change)="selectAll();" id="allcheck"
                      style="background-color: #00000000; border-color:#fff;margin-left:10px;" />
              </th>
              <!-- <th><input type="checkbox" class="form-check-input"
                  id="allcheck" [checked]="SelectAll" (click)="allchecked($event)" style="background-color: #00000000; border-color:#fff;margin-left:10px;" />
              </th> -->
              <th (click)="sort('siteID')">Site ID</th>
              <th (click)="sort('siteName')">Site Name</th>
              <th (click)="sort('customer')">Customer</th>
              <th (click)="sort('status')">Status</th>
              <th (click)="sort('address')">Address</th>
              <!-- <th (click)="sort('lat-long')">Lat & Long</th> -->
              <th (click)="sort('escl_Details')">Escl. Details</th>
              <th (click)="sort('engr_Details')">Engr. Details</th>
              <th>Services</th>
              <th (click)="sort('cntrl_Unit')">Cntrl Unit</th>
              <th>Inventory</th>
              <th>Analytics</th>
              <th>Devices</th>
              <th></th>
            </tr>

            <tr *ngFor="let data of tableData | search : searchText; let i=index">
                <td>
                  <input type="checkbox" class="form-check-input" [(ngModel)]="data.selected" (change)="checkIfAllSelected(); deleteMultiRecords(data, i, $event); ViewByCheckbox(data, i, $event); EditByCheckbox(data, i, $event)" id="singleCheck">
                </td>
                <td>
                  <p>{{data.siteId}}</p>
                </td>
                <td>
                  <p>{{ data.siteName ? data.siteName : '--' }}</p>
                </td>
                <td>
                  <!-- <p>{{data.customer}}</p> -->
                  --
                </td>

                <td>
                  <p [style.color]="data.status == 'Active' ? '#00A44C': data.status == 'Onhold' ? '#F5B400': data.status == 'Inactive' ? '#fa500f': '#084982'">
                    {{ data.status ? data.status : '--' }}
                  </p>
                </td>

                <td class="pointer">
                  <a style="color: #084982;" (click)="addressView($event, i)">View</a>

                  <div class="plus-img" id="address{{i}}">
                    <p class="p-2" style="color: #ABABAB; text-align: left;">ADDRESS</p>
                    <div style="color: #000; text-align: left; padding: 10px;">
                      <p>Pathur Road, Tadepally</p>
                      <p>Guntur - 522501</p>
                      <p>Andhra Pradesh, India</p>
                    </div>
                  </div>
                </td>

                <td>
                  <!-- <a class="pointer" style="color: #084982;">{{data.escl_Details}}</a> -->
                  <a class="pointer" style="color: #084982;" (click)="onGetEngineer(data.siteId); engineerView($event, i)">View</a>

                  <div class="plus-img" style="margin-left: -388px;" id="engineer{{i}}">
                    <p class="p-2" style="color: #ABABAB; text-align: left;">Details:</p>
                    <div class="eng-detail" *ngFor="let item of engineerDetail">
                      <p>
                        <span>Name:&nbsp;</span>
                        {{ item.name ? item.name : '--' }}
                      </p>
                      <p>
                        <span>Email:&nbsp;</span>
                        {{ item.emailId ? item.emailId : '--' }}
                      </p>
                      <p>
                        <span>Contact:&nbsp;</span>
                        {{ item.contactNo ? item.contactNo : '--' }}
                      </p>
                    </div>
                  </div>
                </td>

                <td>
                  <!-- <a class="pointer" style="color: #084982;">{{data.escl_Details}}</a> -->
                  <a class="pointer" style="color: #084982;">View</a>
                </td>

                <td>
                  <!-- <div [ngClass]="data.status == 'Active' ? 'dot-green': data.status == 'Onhold' ? 'dot-yellow': data.status == 'Inactive' ? 'dot-red': 'dot-red'"></div> -->
                  --
                </td>
                <td>
                  <a class="pointer" style="color: #000;" (click)="onGetCentralbox(data.siteId)">
                    <img src="assets/images/add-svg.svg" *ngIf="data.centralUnitId == '' || data.centralUnitId == null" width="25" height="25">
                    <span *ngIf="data.cntrl_Unit != '' && data.centralUnitId !=null">{{data?.centralUnitId}}</span>
                  </a>
                </td>
                <td>
                  --
                </td>
                <td>
                  <!-- <a>
                    <img src="assets/images/add-svg.svg" *ngIf="data.centralUnitId == '' || data.centralUnitId == null " width="25" height="25">
                    <span *ngIf="data.centralUnitId != '' && data.centralUnitId !=null">{{data?.centralUnitId}}</span>
                  </a> -->
                  --
                </td>
                <td>
                  <a class="pointer">
                    <img src="assets/images/add-svg.svg" width="25" height="25" (click)="show('device'); saveSiteData(data)">
                    <!-- <span class="ms-2" (click)="show('device'); saveSiteData(data)" *ngIf="data.cntrl_Unit != '' && data.centralUnitId !=null">1</span> -->
                  </a>
                </td>
                <td>
                  <a class="pointer" (click)="closeDot($event,i)"><img src="assets/images/dotlist.svg" width="30" height="12" /></a>

                  <div class="plus-img1" id="plus{{i}}" style="display: none;">
                    <div class="lists" *ngIf="showIconView1" style="margin-left: -55px; margin-top: -40px;">
                      View
                    </div>
                    <div class="lists" *ngIf="showIconEdit1" style="margin-left: 5px; margin-top: -40px;">
                      Edit
                    </div>
                    <div class="lists" *ngIf="showIconDelete1" style="margin-left: 68px; margin-top: -40px;">
                      Delete
                    </div>

                    <a class="mx-2"><img src="assets/images/view.svg" (click)="openViewPopup(data, i)" (mouseenter)="showIconView1 = true" (mouseleave)="showIconView1 = false" /></a>
                    <a class="mx-2"><img src="assets/images/edit.svg" (click)="openEditPopup(data, i)" (mouseenter)="showIconEdit1 = true" (mouseleave)="showIconEdit1 = false" /></a>
                    <a class="mx-2" value="Delete"><img src="assets/images/delete.svg" (click)="openDeletePopup(data, i)" (mouseenter)="showIconDelete1 = true" (mouseleave)="showIconDelete1 = false" /></a>
                  </div>
                </td>
              </tr>
          </tbody>
      </table>
  </div>
  <!-- /table-->

</div>

<!--  Popup -->
<div class="modalitem max-center" [hidden]="deletePopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Delete Row</p>
      <img src="assets/images/Group 101.svg" width="40" height="40" (click)="closeDeletePopup()" />
    </div>
    <div class="card-body text-center">Do you want to delete this item?</div>
    <div class="card-footer">
      <button type="button" class="btn btn-primary mx-2" (click)="confirmDeleteRow()">
        OK
      </button>
      <button type="button" class="btn btn-danger" (click)="closeDeletePopup()">
        Close
      </button>
    </div>
  </div>
  <!-- </div> -->
</div>

<div class="modalitem max-center" [hidden]="editPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Edit</p>
      <img src="assets/images/Group 101.svg" width="40" height="40" (click)="closeEditPopup()" />
    </div>
    <div class="card-body text-center">
      <ul *ngIf="currentItem">
        <li>
          <h6 style="width: 110px">Site Id</h6>
          :
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.siteId" />
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Customer Name</h6>
          :
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.siteName" />
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Cust Type</h6>
          :
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.cntrl_Unit" />
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Contact Number</h6>
          :
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.services" />
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Status</h6>
          :
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.status" />
          </div>
        </li>
      </ul>
    </div>
    <div class="card-footer">
      <button type="button" class="btn btn-primary mx-2" (click)="confirmEditRow()">
        Update
      </button>
      <button type="button" class="btn btn-danger" (click)="closeEditPopup()">
        Close
      </button>
    </div>
  </div>
  <!-- </div>   -->
</div>

<div class="modalitem max-center" [hidden]="viewPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Assets</p>
      <img src="assets/images/Group 101.svg" width="40" height="40" (click)="closeViewPopup()" />
    </div>
    <div class="card-body text-center">
      <ul *ngIf="currentItem">
        <li>
          <h6 style="width: 110px">Site Id</h6>
          : {{ currentItem?.siteID }}
        </li>
        <li>
          <h6 style="width: 110px">Asset Name</h6>
          : {{ currentItem?.siteName }}
        </li>
        <li>
          <h6 style="width: 110px">Device Mode</h6>
          : {{ currentItem?.cntrl_Unit }}
        </li>
        <li>
          <h6 style="width: 110px">Mime Type</h6>
          : {{ currentItem?.services }}
        </li>
        <li>
          <h6 style="width: 110px">Status</h6>
          : {{ currentItem?.status }}
        </li>
      </ul>
    </div>

    <div class="card-footer">
      <!-- <button type="button" class="btn btn-primary" (click)="confirmViewRow()">OK</button> -->
      <button type="button" class="btn btn-danger" (click)="closeViewPopup()">
        Close
      </button>
    </div>
  </div>
  <!-- </div> -->
</div>
<!-- /Popup -->


<div style="position: fixed; top:0;" *ngIf="showAddSite">
    <app-add-new-site (newItemEvent)="closenow('site', $event)"></app-add-new-site>
</div>

<div style="position: fixed; top:0;" *ngIf="showAddDevice">
  <app-add-device (newItemEvent)="closenow('device', $event)"></app-add-device>
</div>
