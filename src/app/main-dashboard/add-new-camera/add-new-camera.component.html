<div class="row formModal">
  <div class="col-lg-4 col-4"></div>

  <div class="col-lg-8 col-8 add-form" id="sites" @inOutPaneAnimation>

    <div>
      <a class="close-main pointer" (click)="closeCamera()"><img src="assets/icons/close_form.svg" /></a>
      <span class="form-heading">Add Camers</span>
    </div>

    <div>
      <form [formGroup]="createCamera">
        <div class="row">
          <div class="col-lg-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Username</mat-label>
              <input matInput formControlName="userName">
            </mat-form-field>
          </div>
          
          <div class="col-lg-6">
            <mat-form-field appearance="outline" class="w-100">
                <mat-label>Password</mat-label>
                <input matInput formControlName="password">
              </mat-form-field>
            </div>

            <!-- <div class="col-lg-6">
              <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Display Name</mat-label>
                  <input matInput formControlName="displayName">
                </mat-form-field>
              </div> -->
  
            <div class="col-lg-12">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>RTSP URL</mat-label>
                <input matInput formControlName="rtspUrl" >
              </mat-form-field>
            </div>
            
            <div class="col-lg-12">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>WebRTC URL</mat-label>
                <input matInput formControlName="videoServerName" [(ngModel)]="webrtcUrl">
              </mat-form-field>
            </div>
            
            <div class="col-lg-12">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>HLS URL</mat-label>
                <input matInput formControlName="HLSUrl" [(ngModel)]="hlsTunnel">
              </mat-form-field>
            </div>
            
            <div class="col-lg-12">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>Audio URL</mat-label>
                <input matInput formControlName="audioUrl" [(ngModel)]="audioUrl">
              </mat-form-field>
            </div>
        </div>

          <div class="row">
            <div class="col-lg-6">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>Unit Id</mat-label>
                <input matInput formControlName="unitId"  [(ngModel)]="unitId" (input)="generateUrls()">
              </mat-form-field>
            </div> 

            <div>
              <!-- <p><strong>Camera Config URL:</strong> {{ cameraconfigUrl }}</p>
              <p><strong>Snapshots URL:</strong> {{ snapshotsUrl }}</p> -->
              <!-- <p><strong>WebRTC URL:</strong> {{ webrtcUrl }}</p>
              <p><strong>HLS Tunnel:</strong> {{ hlsTunnel }}</p>
              <p><strong>Audio URL:</strong> {{ audioUrl }}</p> -->
            </div>


            <div class="col-lg-4">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>No of Cameras</mat-label>
                <input matInput type="number" formControlName="noOfCameras" #noOfCams >
              </mat-form-field>
            </div>

            <div class="col-lg-4">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>camera_config_url</mat-label>
                <input matInput type="text" formControlName="camera_config_url">
              </mat-form-field>
            </div>
            <div class="col-lg-4"> 
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>snapshotUrl</mat-label>
                <input matInput type="text" formControlName="snapshotUrl">
              </mat-form-field>
            </div>
            <div class="col-lg-4">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>s3_server_host</mat-label>
                <input matInput type="number" formControlName="s3_server_host">
              </mat-form-field>
            </div>
            <div class="col-lg-4">
              <mat-form-field appearance="outline" class="w-100">
                <mat-label>timelapse</mat-label>
                <input matInput type="text" formControlName="timelapse">
              </mat-form-field>
            </div>
            
            <div class="col-lg-2 text-end">
              <button class="btn btn-primary w-100" (click)="getCamerasForSiteId(currentSiteFrom)">ADD</button>
            </div>
        </div >
      </form>
      
      
      <div class="table-res" *ngIf="camList.length !== 0">
        <table class="table table-hover">
          <thead>
            <tr class="form1">
              <th>Camera Id</th>
              <th>User Name</th>
              <th>Password</th>
              <th>Display Name</th>
              <th>RTSP</th>
              <th>WebRTC URL</th>
              <th>HLS URL</th>
              <th>Audio URL</th>
              <th>Snapshot Url</th>
              <th>Camera Config Url</th>
              <th></th>
            </tr>
          </thead>
          
          <tbody>
            <tr *ngFor="let cam of camList; let i=index">
                <td>{{cam.cameraId}}</td>
                <td>{{cam.userName}}</td>
                <td>{{cam.password}}</td>
                <td>{{cam.displayName}}</td>
                <td>{{cam.rtspUrl}}</td>
                <td>{{cam.videoServerName}}</td>
                <td>{{cam.HLSUrl}}</td>
                <td>{{cam.audioUrl}}</td>
                <td>{{cam.snapshotUrl}}</td>
                <td>{{cam.camera_config_url}}</td>
                <td>
                  <div class="d-inline-flex">
                    <button class="btn btn-success p-1" style="font-size: 10px;" (click)="submit(cam, $event)">
                      Save
                    </button>
                    <button class="btn btn-danger p-1 ms-1" style="font-size: 10px;" (click)="openEditPopup(cam)" [disabled]="editDisabledFlags[cam.id]">
                      Edit
                    </button>
                  </div>
                </td>
              </tr>
          </tbody>
        </table>
      </div>

      <div class="text-center">
        <button class="btn btn-dark my-2" (click)="closeCamera()">Done</button>
      </div>
    </div>
</div>


<ng-template #editSiteDialog>
  <div style="background-color: #084982;">
    <p class="dialog-title">MODIFY SITE</p>
  </div>

  <div class="row m-0 dialog-content">
    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Unit Id</mat-label>
        <input matInput [(ngModel)]="currentItem.unitId">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Username</mat-label>
        <input matInput [(ngModel)]="currentItem.userName">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Password</mat-label>
        <input matInput [(ngModel)]="currentItem.password">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>RTSP URL</mat-label>
        <input matInput [(ngModel)]="currentItem.rtspUrl">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>WebRTC URL</mat-label>
        <input matInput [(ngModel)]="currentItem.videoServerName">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>HLS URL</mat-label>
        <input matInput [(ngModel)]="currentItem.HLSUrl">
      </mat-form-field>
    </div>

    <div class="col-lg-6">
      <mat-form-field appearance="outline" class="w-100">
        <mat-label>Audio URL</mat-label>
        <input matInput [(ngModel)]="currentItem.audioUrl">
      </mat-form-field>
    </div>
  </div>

  <div class="d-flex align-items-center justify-content-end">
    <div>
      <button class="dialog-close-btn" mat-dialog-close>Close</button>
    </div>
    <div  >
      <button class="dialog-update-btn" mat-dialog-close (click)="update()">Update</button>
    </div>
  </div>
</ng-template>
