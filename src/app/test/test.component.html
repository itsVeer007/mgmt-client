<div class="container-fluid users" id="top">

  <!-- header -->
  <div class="d-flex align-items-center justify-content-between">
    <div class="users-header">
      <p>List of Assets - <span>{{ assetTable.length }}</span></p>
    </div>

    <div>
      <a class="pointer">
        <img src="assets/icons/sites-img.svg" alt=""
          style="border-radius: 24px; box-shadow: 7px 7px 7px 0px #f3f3f3; margin-top: -9px;">
      </a>
    </div>
  </div>
  <!-- /header -->

  <!-- status -->
  <div class="row">
    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-green"></div>
      <div class="mx-2">
        <div class="status">Added</div>
        <div class="count">{{ added.length }}</div>
      </div>
    </div>

    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-red"></div>
      <div class="mx-2">
        <div class="status">Removed</div>
        <div class="count">{{ removed.length }}</div>
      </div>
    </div>

    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-yellow"></div>
      <div class="mx-2">
        <div class="status">Synced</div>
        <div class="count">{{ synced.length }}</div>
      </div>
    </div>

    <div class="col-lg-1 col-md-1 d-flex justify-content-start">
      <div class="vl-yellow"></div>
      <div class="mx-2">
        <div class="status">Pending</div>
        <div class="count">{{ pending.length }}</div>
      </div>
    </div>
  </div>
  <!-- /status -->

  <!-- form -->
  <div class="search-form d-flex align-items-center justify-content-between my-2">
    <div class="row">
      <div class="col-lg-6 col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Select site</mat-label>
          <mat-select>
            <mat-option *ngFor="let site of siteNameId" [value]="site.id" (click)="getAdsDevicesBySite(site.id)">{{site.name}}</mat-option>
          </mat-select>
          <mat-error class="mt-1">Role is required</mat-error>
        </mat-form-field>
      </div>

      <div class="col-lg-6 col-md-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Select device</mat-label>
          <mat-select>
            <mat-option *ngFor="let dev of adsDevicesBySite" [value]="dev.id" (click)="assetsByDevice(dev.id)">{{dev.name}}</mat-option>
          </mat-select>
          <mat-error class="mt-1">Role is required</mat-error>
        </mat-form-field>
      </div>
    </div>

    <div class="table-icons">
      <div class="lists" *ngIf="showIconView" style="margin-right: 60px; margin-top: -40px">
        View
      </div>
      <div class="lists" *ngIf="showIconEdit" style="margin-right: 30px; margin-top: -40px">
        Edit
      </div>
      <div class="lists" *ngIf="showIconDelete" style="margin-right: -5px; margin-top: -40px">
        Delete
      </div>

      <a class="mx-2" (click)="viewBySelectedOne()"><img src="assets/icons/view.svg" (mouseenter)="showIconView = true" (mouseleave)="showIconView = false" /></a>
      <a class="mx-2" (click)="editBySelectedOne()"><img src="assets/icons/edit.svg" (mouseenter)="showIconEdit = true" (mouseleave)="showIconEdit = false" /></a>
      <a class="mx-2" (click)="deleteSelected()"><img src="assets/icons/delete.svg" (mouseenter)="showIconDelete = true" (mouseleave)="showIconDelete = false" /></a>
    </div>
  </div>
  <!-- /form -->

      <!-- table -->
      <div class="table-resp w-100">
        <table class="table" id="mytable">
          <thead>
            <tr class="form1">
              <th>
                <input type="checkbox" class="form-check-input" [(ngModel)]="selectedAll" (change)="selectAll()" id="allcheck"
                  style="background-color: #00000000; border-color: #fff; margin-left: 10px;">
              </th>
              <th (click)="sort('siteId')">Id</th>
              <th (click)="sort('customerName')">Name</th>
              <!-- <th  (click)="sort('siteId')">
                <div class="d-flex align-items-center">
                  Site details<img class="pointer ms-1" (mouseover)="showDetail()" (mouseout)="hideDetail()" src="assets/icons/info_white.svg">
                </div>
                <div class="info" *ngIf="info">Device Id + Device Name</div>
              </th> -->
              <th (click)="sort('siteId')">
                <div class="d-flex align-items-center">
                  Device details<img class="pointer ms-1" src="assets/icons/info_white.svg">
                </div>
              </th>
              <th (click)="sort('address')">Device mode</th>
              <!-- <th (click)="sort('address')">Mime Type</th> -->
              <th (click)="sort('address')">Duration</th>
              <th (click)="sort('address')">Start date</th>
              <th (click)="sort('address')">End date</th>
              <!-- <th (click)="sort('address')">Details</th> -->
              <th (click)="sort('status')">Status</th>
              <th (click)="sort('status')">Add</th>
              <th (click)="sort('status')" class="text-center">Ads details</th>
              <th (click)="sort('status')" class="text-center">Play</th>
              <th></th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let item of assetTable | search: searchText; let i = index;">
              <td>
                <input type="checkbox" class="form-check-input" [(ngModel)]="item.selected" (change)="checkIfAllSelected(); deleteMultiRecords(item, i, $event); ViewByCheckbox(item, i, $event); EditByCheckbox(item, i, $event)" id="singleCheck">
              </td>

              <td>
                <p>{{ item.id }}</p>
              </td>

              <td>
                <p>{{ item.asset_name ? item.asset_name : '--' }}</p>
              </td>

              <!-- <td>
                <p>{{ siteIdList + ' ' + '--'}}</p>
              </td> -->

              <td>
                <p>{{ item.deviceId + ' ' + '--'}}</p>
              </td>

              <td>
                <p *ngIf="item.deviceModeId == 1">BS</p>
                <p *ngIf="item.deviceModeId == 2">BSR</p>
                <p *ngIf="item.deviceModeId == 3">ODR</p>
                <!-- <p>{{item.deviceModeId}}</p> -->
              </td>

              <!-- <td>
                  <p>{{ item.mimetype }}</p>
                </td> -->

              <td>
                <p>{{item.duration}}</p>
              </td>

              <td>
                <p>{{item.start_date ? item.start_date : currentDateTime}}</p>
              </td>

              <td>
                <p>{{item.end_date ? item.end_date : endDateTime}}</p>
              </td>

              <!-- <td>
                <p>{{item.description}}</p>
              </td> -->
              <!-- <td>
                  <button class="bg-white" style="color: #084982">{{ item.address }}</button>
                </td> -->

              <td>
                <p [style.color]="item.status == 1 ? '#F5B400' : item.status == 2 ? '#00A44C' : item.status == 5 ? '#fa500f' : '#00A44C'">

                  <span class="d-flex justify-content-between">
                    <span>
                      {{ item.status == 1 ? "Pending": item.status == 2 ? "Added" : item.status == 3 ? '' : item.status == 4 ? "Synced" : item.status == 5 ? "Removed" : '--'}}
                    </span>
                    <a class="pointer" [matMenuTriggerFor]="menu" #menuTrigger>
                      <img src="assets/icons/edit.svg"  width="13">
                    </a>
                  </span>


                  <!-- <button mat-button color="primary" [matMenuTriggerFor]="menu" #menuTrigger>Edit</button> -->
                  <mat-menu #menu="matMenu">
                    <mat-form-field appearance="outline" class="w-100">
                      <mat-label>Edit Status</mat-label>
                      <mat-select>
                        <mat-option>SentToController</mat-option>
                        <mat-option>Synced</mat-option>
                      </mat-select>
                    </mat-form-field>
                    <!-- <button mat-raised-button color="primary">Edit Status</button> -->
                  </mat-menu>
                </p>
              </td>

              <td class="text-center">
                <button style="background: transparent; border: none;" (click)="showAddAsset()">
                  <img src="assets/icons/add.svg" alt="" width="30" height="30">
                </button>
              </td>

              <td class="text-center">
                <a class="pointer" (click)="openDialog()">
                  <img style="color: #bdb8b8;" src="assets/icons/live_tv.svg" width="20" height="20" />
                </a>
              </td>

              <td class="text-center">
                <a class="pointer" href="http://192.168.0.135:8080/getAssetFile_1_0?assetName=anand_test_99.mp4&deviceId=IVISIND1102DV1" target="_blank">
                  <img style="color: #bdb8b8;" src="assets/icons/play.svg" width="25" height="25" />
                </a>
              </td>

              <!-- <td>
                <video autoplay controls src="http://192.168.0.135:8080/getAssetFile_1_0?assetName=anand_test_99.mp4&deviceId=IVISIND1102DV1" type="video/mp4"></video>
              </td> -->

              <td style="position: relative;">
                <a class="pointer" (click)="closeDot($event, i)"><img src="assets/icons/dotlist.svg" width="30" height="12" /></a>

                <div class="plus-img1" id="plus-img{{i}}" style="display: none">
                  <div class="lists" *ngIf="showIconView1" style="margin-left: 5px; margin-top: -20px">
                    View
                  </div>
                  <div class="lists" *ngIf="showIconEdit1" style="margin-left: 38px; margin-top: -20px">
                    Edit
                  </div>
                  <div class="lists" *ngIf="showIconDelete1" style="margin-left: 63px; margin-top: -20px">
                    Delete
                  </div>

                  <a class="mx-2" (click)="openViewPopup(item, i)"><img src="assets/icons/view.svg" (mouseenter)="showIconView1 = true" (mouseleave)="showIconView1 = false" /></a>
                  <a class="mx-2" (click)="openEditPopup(item, i)"><img src="assets/icons/edit.svg" (mouseenter)="showIconEdit1 = true" (mouseleave)="showIconEdit1 = false" /></a>
                  <!-- <a class="mx-2" value="Delete" (click)="deleteRow1(item, i)"><img src="assets/icons/delete.svg" /></a> -->
                  <a class="mx-2" value="Delete" (click)="openDeletePopup(item, i)"><img src="assets/icons/delete.svg" (mouseenter)="showIconDelete1 = true" (mouseleave)="showIconDelete1 = false" /></a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Loader -->
        <div *ngIf="showLoader" class="d-flex justify-content-center align-items-center" style="height: 50vh;">
          <app-loader></app-loader>
        </div>
        <!-- /Loader -->

      </div>
      <!-- table -->

</div>

<div class="modalitem max-center" [hidden]="deletePopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Delete Row</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeDeletePopup()" />
    </div>
    <div class="card-body text-center">Do you want to delete this item?</div>
    <div class="card-footer">
      <button type="button" class="btn btn-primary mx-2" (click)="confirmDeleteRow()">
        OK
      </button>
      <button type="button" class="btn btn-danger" (click)="closeDeletePopup()">
        Close
      </button>
    </div>
  </div>
</div>

<div class="modalitem max-center" [hidden]="editPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Edit</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeEditPopup()">
    </div>
    <div class="card-body text-center">
      <ul *ngIf="currentItem">
        <li>
          <h6 style="width: 110px">Site Id</h6>
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.id">
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Device mode</h6>
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.deviceModeId">
          </div>
        </li>
        <li>
          <h6 style="width: 110px">From date</h6>
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.fromDate">
          </div>
        </li>
        <li>
          <h6 style="width: 110px">To date</h6>
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.toDate">
          </div>
        </li>
        <li>
          <h6 style="width: 110px">Status</h6>
          <div>
            <input type="text" class="form-control my-1" [(ngModel)]="currentItem.status">
          </div>
        </li>
      </ul>
    </div>
    <div class="card-footer">
      <button type="button" class="btn mx-2" style="background-color: #084982; color: #ffffff;" (click)="confirmEditRow()">
        Update
      </button>
      <button type="button" class="btn btn-danger" (click)="closeEditPopup()">
        Close
      </button>
    </div>
  </div>
</div>

<div class="modalitem max-center" [hidden]="viewPopup">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <p>Assets</p>
      <img src="assets/icons/close_form.svg" width="40" height="40" (click)="closeViewPopup()" />
    </div>
    <div class="card-body text-center">
      <ul *ngIf="currentItem">
        <li>
          <h6 style="width: 110px">Site Id</h6>
          : {{ currentItem?.siteId }}
        </li>
        <li>
          <h6 style="width: 110px">Asset Name</h6>
          : {{ currentItem?.asset_name }}
        </li>
        <li>
          <h6 style="width: 110px">Device Mode</h6>
          : {{ currentItem?.deviceMode }}
        </li>
        <li>
          <h6 style="width: 110px">Mime Type</h6>
          : {{ currentItem?.mimetype }}
        </li>
        <li>
          <h6 style="width: 110px">Start Date</h6>
          : {{ currentItem?.start_date }}
        </li>
        <li>
          <h6 style="width: 110px">End Date</h6>
          : {{ currentItem?.end_date }}
        </li>
        <li>
          <h6 style="width: 110px">Status</h6>
          : {{ currentItem?.status }}
        </li>
      </ul>
    </div>

    <div class="card-footer">
      <!-- <button type="button" class="btn btn-primary" (click)="confirmViewRow()">OK</button> -->
      <button type="button" class="btn btn-danger" (click)="closeViewPopup()">
        Close
      </button>
    </div>
  </div>
  <!-- </div> -->
</div>

<ng-template #myCityDialog>

  <!-- <div class="d-flex align-items-center">
    <div mat-dialog-actions>
      <button mat-button mat-dialog-close>Update</button>
    </div>
    <div mat-dialog-actions>
      <button mat-button mat-dialog-close>Close</button>
    </div>
  </div> -->
</ng-template>


<div style="position: fixed; top: 70px; right: 0; z-index: 99; width: 100%;" *ngIf="showAsset">
  <app-add-new-asset  (newItemEvent)="closenow($event, 'asset')"></app-add-new-asset>
</div>

<!-- <app-vjs-player #vjs [options]="{ autoplay: true, controls: false, fluid: true, sources: [{ src: videoElement , type: 'application/x-mpegURL' }]}"></app-vjs-player> -->
